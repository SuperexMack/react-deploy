name: Remote SSH Command
on: [push]
jobs:
  deploy:
    name: Building CD pipeline
    runs-on: ubuntu-latest
    steps:
    - name: Checkout codee
      uses: actions/checkout@v2
    - name: Execute CD pipelinee
      uses: appleboy/ssh-action@v1.2.0
      with:
        host: 62.72.30.103
        username: ubuntu
        key: ${{ secrets.PRIVATE_KEY_VPS }}
        port: 22
        script: |
          cd react-deploy/client
          git pull origin master
          npm install
          npm run build
          npm install -g http-server
          pm2 delete react-app || true
          pm2 start "http-server dist -p 8000 -a 0.0.0.0" --name react-app